<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Sequence Input</title>
  
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript">
    google.load("jquery", "1.4.2");
  </script>
  <script type="text/javascript" src="js/simpletabs_1.3.js"></script>
  <style type="text/css">
    @import "css/simpletabs.css"
  </style>
  
  <script type="text/javascript">
    $(document).ready(function() { 
	  $("#comparison").change(function() {
	    if($("#comparison").val() == "Custom List") {
		  $("#customList").show()
                  validateFormsNotEmpty()
		}
		else {
		  $("#customList").hide()
                  validateFormsNotEmpty()
		}
	  })

      $("#customList").find("#add").click(addToCustomList)
      validateFormsNotEmpty()
      bindValidate()
    });

    function removeFromCustomList() {
      $(this).parent().parent().remove()
      bindValidate()
      validateFormsNotEmpty()
    }

    function addToCustomList() {
      newRow = '<tr><td>Species:<input type="text" id="speciesInput"/>\
              Input Type:\
              <select>\
                <option value="Organism Name">Organism Name</option>\
                <option value="Taxonomy Id">Taxonomy Id</option>\
              </select>\
              <button type="button" id="add">Add New Row</button>\
              <button type="button" id="remove" style="display:none">Remove</button></td></tr>'
      $(this).hide()
      $(this).parent().find("#remove").show()
      $(this).parent().find("#remove").click(removeFromCustomList)
      $('#customList').find('tbody').append(newRow)
      $("#customList tr:last").find("#add").click(addToCustomList)
      bindValidate()
      validateFormsNotEmpty()
    }

    function bindValidate() {
      $("#remove").click(validateFormsNotEmpty)
      $("#add").click(validateFormsNotEmpty)
      $("#sequenceName").bind("change keyup input paste", validateFormsNotEmpty)
      $("#sequenceText").bind("change keyup input paste", validateFormsNotEmpty)
      $("#sequenceFile").bind("change keyup input paste", validateFormsNotEmpty)
      $("#speciesInput").bind("change keyup input paste", validateFormsNotEmpty)
      rows = $("#customList").find("tbody").children().children()
      $.each(rows, function(index, value) {
        $(value).find("#speciesInput").bind("change keyup input paste", validateFormsNotEmpty)
      })
      $("#comparison").bind("change keyup input paste", validateFormsNotEmpty)
      $(".simpleTabsNavigation").bind("click change keyup input paste",validateFormsNotEmpty)
    }

    function validateFormsNotEmpty() {
      valid = true
      tabs = $(".simpleTabs").find("a")
      if(tabs[0].className.indexOf("current") != -1) {
        valid = valid && ($("#sequenceFile").val() != "")
      } 
      else {
        valid = valid && ($("#sequenceText").val() != "") && ($("#sequenceName").val() != "")
      }

      if($("#customList").is(":visible")) {
        rows = $("#customList").find("tbody").children().children() 
        $.each(rows, function(index, value) {
          valid = valid && ($(value).find("#speciesInput").val() != "")
        })
      }
       
      if(valid)
        $("#submitRequest").removeAttr("disabled")
      else
        $("#submitRequest").attr('disabled', 'disabled')
    }
  </script>
</head>

<body>
  <h2>Codon Analysis</h2>
 
  <div class="simpleTabs">
    <ul class="simpleTabsNavigation">
      <li><a href="#">Upload a File</a></li>
      <li><a href="#">Input Sequence</a></li>
    </ul>
    <div class="simpleTabsContent">
      Codon Sequence: <input type="file" id="sequenceFile"><br>
      File Format: 
      <select>
        <option value="FASTA">FASTA</option>
	<option value="GenBank">GenBank</option>
	<option value="Plain Text">Plain Text</option>
      </select>
    </div>
    <div class="simpleTabsContent">
      Name: <input type="text" id="sequenceName"> <br>
      Codon Sequence: <input type="text" id="sequenceText"><br>
    </div>
  </div><br>

  <div id="generalInput">
    Comparison Host: 
    <select id="comparison">
      <option value="Custom List">Custom List</option>
      <option value="GenBank">GenBank</option>
      <option value="RefSeq" selected="selected">RefSeq</option>
    </select><br>
    <div id="customList" style="display:none">
      <table>
        <tbody>
          <tr>
            <td>
	      Species:<input type="text" id="speciesInput"/>
              Input Type:
	      <select>
                <option value="Organism Name">Organism Name</option>
	        <option value="Taxonomy Id">Taxonomy Id</option>
              </select>
              <button type="button" id="add">Add New Row</button>
              <button type="button" id="remove" style="display:none">Remove</button>
            </td>
          </tr>  
        </tbody>
      </table>
    </div>
    <button type="button" id="submitRequest" disabled>Submit Request</button>
  </div> 
</body>
</html>
